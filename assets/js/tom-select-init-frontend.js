(function(){function r(n){if(n.hasOwnProperty("tomselect"))return;n.setAttribute("aria-hidden","true");const o=(e,s)=>{const{restUrl:t}=window.tom_select_init_frontend_strings,a=new URL(`${t}wp/v2/search`);return a.searchParams.append("search",e),a.searchParams.append("type",s.searchType),a.searchParams.append("subtype",s.searchSubtype),a.searchParams.append("per_page",s.paginationPerPage),a.searchParams.append("page",s.paginationPage),a},g={plugins:[],valueField:"id",labelField:"title",searchField:"title",maxItems:null,maxOptions:null,paginationPage:1,paginationPerPage:20,paginationTotalPages:1,render:{option:(e,s)=>`<div class="${e.$option?.classList.toString()||""}"><span class="ts-option-label">${s(e.title)}</span></div>`},firstUrl:e=>o(e,this.settings),onItemAdd:function(){this.setTextboxValue(""),this.refreshOptions()},load:function(e,s){if(!this.settings.plugins.includes("virtual_scroll")){s();return}fetch(o(e,this.settings)).then(t=>{if(this.settings.paginationTotalPages=Number(t.headers.get("x-wp-totalpages"))||1,this.settings.maxOptions=Number(t.headers.get("x-wp-total"))||null,!t.ok)throw t.status;return t.json()}).then(t=>{this.settings.paginationTotalPages>this.settings.paginationPage?(this.settings.paginationPage=this.settings.paginationPage+1,this.setNextUrl(e,o(e,this.settings))):this.setNextUrl(e,null),s(t)}).catch(t=>{console.log(t),s()})}},d=JSON.parse(n.getAttribute("data-ts-settings")),l=Object.assign(g,d);Array.isArray(n.dataset.selectedItems)&&n.dataset.selectedItems.length&&(l.items=n.dataset.selectedItems);const i=new TomSelect(n,l);l.plugins.includes("virtual_scroll")&&(i.on("focus",function(){i.settings.paginationPage=i.settings.paginationPage+1,i.setNextUrl("",o("",i.settings))}),i.on("type",function(){i.settings.paginationPage=1,i.setNextUrl("",o("",i.settings))}))}function c(){if(typeof TomSelect!="function"){console.log("TomSelect not available!");return}document.querySelectorAll("select.gfield_select_tomselect").forEach(r)}window.gravityformsadvancedselectInitializeTomSelect=c,typeof jQuery<"u"?jQuery(document).on("gform_post_render",gravityformsadvancedselectInitializeTomSelect):document.addEventListener("DOMContentLoaded",gravityformsadvancedselectInitializeTomSelect)})();
